<!DOCTYPE HTML>
<html>
    <head>
        <meta charset='UTF-8' />
        <title>Scilab WebView</title>
        <script type='text/javascript' src='/socket.io/socket.io.js'></script>
        <style type='text/css'>
body {
    background-color : rgb(192,192,192);
    color : black;
    text-align : center;
}

.log {
    background-color : white;
    opacity : 1;
    width : 500px;
    height : 100px;
    margin : auto;
    text-align:left;
    border : 2px rgb(0,0,0) solid;
    overflow : auto;
    font-family: 'Lucida Console', Monaco, monospace;
    font-size:11px;
}

.GO_FIGURE {
    /*
        "position" must be relative or absolute 
        to allow absolue positioning of children
    */
    position: relative;
    background-color : rgb(192,192,192);
    width : 610px;
    height : 460px;
    margin : auto;
    //border : 2px rgb(0,0,0) solid;
    overflow : auto;
    text-align: left;
}

.GO_PUSHBUTTON {
    position: absolute;
    text-align:center;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size: 11px;
    visibility:inherit;
}

.GO_FRAME {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    text-align:center;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size:11px;
    //border : 1px rgb(0,0,0) solid;
    visibility:inherit;
}

.GO_TEXT {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    line-height:20px;
    text-align:left;
    vertical-align: middle;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size:11px;
    visibility:inherit;
}

.GO_EDIT {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    text-align:left;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size:11px;
    visibility:inherit;
}

.GO_CHECKBOX {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    line-height:20px;
    text-align:left;
    vertical-align: middle;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size:11px;
    visibility:inherit;
}

.GO_CHECKBOX_LABEL {
    background-color : inherit;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    text-align:left;
    overflow : hidden;
    font-family: inherit;
    font-size:inherit;
    visibility:inherit;
}

.GO_CHECKBOX_CHECKBOX {
    background-color : inherit;
    left: 0px;
    bottom: 0px;
    overflow : hidden;
    visibility:inherit;
}

.GO_RADIO {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    line-height:20px;
    text-align:left;
    vertical-align: middle;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size:11px;
    visibility:inherit;
}

.GO_RADIO_LABEL {
    background-color : inherit;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    text-align:left;
    overflow : hidden;
    font-family: inherit;
    font-size:inherit;
    visibility:inherit;
}

.GO_RADIO_RADIO {
    background-color : inherit;
    left: 0px;
    bottom: 0px;
    overflow : hidden;
    visibility:inherit;
}

.GO_SLIDER {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    overflow : hidden;
    visibility:inherit;
}

.GO_LISTBOX {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    overflow : auto;
    visibility:inherit;
}

.GO_COMBOBOX {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    overflow : auto;
    visibility:inherit;
}

.GO_SPINNER {
    position: absolute;
    background-color : white;
    left: 20px;
    bottom: 40px;
    width : 40px;
    height : 20px;
    text-align:right;
    overflow : hidden;
    font-family: Tahoma, Verdana, Segoe, sans-serif;
    font-size:11px;
    visibility:inherit;
}

.window {
    /*
        "position" must be relative or absolute 
        to allow absolue positioning of children
    */
    position: relative;
    background-color : rgb(192.192.192);
    margin : auto;
    /*
    border : 2px rgb(0,0,0) solid;
    */
    overflow : auto;
    text-align: left;
}

#infobar {
    background-color : rgb(192,192,192);
    opacity : 1;
    width : 500px;
    height : 20px;
    margin : auto;
    border : 1px rgb(0,0,0) solid;
    font-weight: bold;
}
        </style>
    </head>
    <body>
        <h1>Scilab WebView</h1>
        <table width=200 height=100>
            <tr>
                <td bgcolor="red"></td>
                <td bgcolor="yellow" colspan="2"></td>
            </tr>
            <tr>
                <td bgcolor="lime"></td>
                <td bgcolor="magenta"></td>
                <td bgcolor="cyan" rowspan="2"></td>
            </tr>
            <tr>
                <td bgcolor="blue" colspan="2"></td>
            </tr>
        </table>
        <br>
        <table width=200 height=100>
            <tr>
                <td bgcolor="red"></td>
                <td bgcolor="yellow" rowspan="2"></td>
                <td bgcolor="magenta"></td>
            </tr>
            <tr>
                <td bgcolor="lime"></td>
                <td bgcolor="cyan" rowspan="2"></td>
            </tr>
            <tr>
                <td bgcolor="blue" colspan="2"></td>
            </tr>
        </table>
        
        <div id='infobar'></div>
        <h3>Logger:</h3>
        <div class='log' id='logger'></div>
        <br>
        <div class='window' id='scilab'></div>
        
        <script type='text/javascript'>
            var command;
            // connect to server
            var socket = io();

            resetLogger();
            setInfo('');
            
            function onPushButton() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                socket.emit("callback", {uid:id});
           }
            
            function onCheckBox() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                socket.emit("callback", {uid:id, value:this.checked});
            }
            
            function onRadioButton() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                socket.emit("callback", {uid:id, value:this.checked});
            }

            function onListBox() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                var data = [];
                for(var i = 0 ; i < this.options.length; ++i) {
                    if(this.options[i].selected) {
                        data.push(i);
                    }
                }
                socket.emit("callback", {uid:id, value:data});
            }
            
            function onComboBox() {
            }
            
            function onTab() {
            }
            
            function onSlider() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                socket.emit("callback", {uid:id, value:parseFloat(this.value)});
            }
            
            function onEditBox() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                socket.emit("callback", {uid:id, value:this.value});
           }
            
            function onSpinner() {
                var id = parseInt(this.id.substring(3)); //ignore "uid"
                socket.emit("callback", {uid:id, value:parseFloat(this.value)});
            }
            
            //tools
            function setInfo(data) {
                document.getElementById('infobar').innerHTML = data;
            }
            
           function resetLogger() {
                var objDiv = document.getElementById('logger');
                objDiv.innerHTML = '';
            }
            
           function setLogger(data) {
                var objDiv = document.getElementById('logger');
                objDiv.innerHTML += data + '</br>';
                objDiv.scrollTop = objDiv.scrollHeight;
            }
            
            //socket events management
            socket.on('command_end', function () {
            });

            socket.on('disconnect', function () {
                setInfo('Connection lost');
            });
            
            socket.on('status', function (msg) {
                if(msg.data == "ready") {
                    setInfo("Scilab is ready");
                    resetLogger();
                    //reset "scilab" page
                    var parent = document.getElementById('scilab');
                    parent.innerHTML = "";
                } else {
                    setInfo("Scilab is busy");
                }
                setLogger('<font color="black">' +  msg.data + '</font>');
            });
            
            socket.on('graphic_create', function (msg) {
                //setLogger('<font color="green">' +  msg.data + '</font>');
                eval(msg.data);
            });
            
            socket.on('graphic_delete', function (msg) {
                //setLogger('<font color="red">' + 'graphic_delete(' + msg.uid + ')' + '</font>');
                eval(msg.data);
            });
            
            socket.on('graphic_update', function (msg) {
                //setLogger('<font color="orange">' +  msg.data + '</font>');
                eval(msg.data);
            });
        </script>
    </body>
</html>
