<?xml version="1.0" encoding="UTF-8"?>
<!--
Allan CORNET
INRIA 2007
-->
<project name="jvm" default="compile">
  <property name="rootdirectory"  location="../../../../.." />
  <property name="dist"  location="${rootdirectory}/java/jar/modules" />
  <property name="src"  location="." />

  <taskdef resource="checkstyletask.properties" classpath="${rootdirectory}/java/checkstyle/checkstyle-all-4.3.jar"/>
      
  <description>
			build jvm module
  </description>
  
	<target name="checkstyle-scilab">
		<checkstyle config="${rootdirectory}/checkstyle/scilab_checkstyle_convention.xml">
  		<fileset dir="${src}" includes="**/*.java"/>
  		<!-- Location of cache-file. -->
  		<property key="checkstyle.cache.file" file="build/cachefile"/>
		</checkstyle> 
	</target>  
    
  <target name="init">
		<!-- Create the time stamp -->
		<tstamp/>
	</target>    

  <target name="clean" description="clean sources">
  	<delete dir="build"/>
    <delete file="${dist}/jvm.jar"/>
  </target>

<!-- 
  <target name="compile" description="build sources" depends="init,checkstyle-scilab">
-->
  <target name="compile" description="build sources" depends="init">
  	<mkdir dir="build/classes"/>
    <javac srcdir="${src}" destdir="build/classes"/>
  </target>

  <target name="jar" description="do .jar file" depends="compile">
		<jar destfile="${dist}/jvm.jar" basedir="build/classes">
    	<manifest>
      	<attribute name="ClassPath" value="org.scilab.modules.jvm.ClassPath"/>
			</manifest>
		</jar>
  </target>
</project>
