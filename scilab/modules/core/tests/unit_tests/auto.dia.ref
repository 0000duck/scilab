// <-- TEST WITH GRAPHIC -->
// Copyright INRIA
// test conversion transfer <---> state-space
// 1- coff inversion
 s=poly(0,'s'); a=[1 2 3;4 5 6;7 8 9];
 [num,den]=coff(a,'s');h1=num/den;h2=(s*eye()-a)^(-1);
 e=h1-h2;if norm(coeff(e(2)))>5000*%eps then bugmes();quit;end
// 2-test de tf2ss et ss2tf
 n=[1+s   2+3*s+4*s^2        5; 0        1-s             s];
 d=[1+3*s   5-s^3           s+1;1+s     1+s+s^2      3*s-1];
 h=syslin('c',n./d);
 [n,d]=simp(n,d);if h<>rlist(n,d,'c') then bugmes();quit;end
 sl=tf2ss(h); e=h-ss2tf(sl);
 if norm(coeff(e(2)))>100000*%eps then bugmes();quit;end
//
  a = [0.8604043 , 0.0070020 , 0.6223373 , -1.356213 , -4.2301775
       0.159714 ,  0.0857791 , -0.2367751 , 0.4958580 , 0.6398817
      -4.3054931 , -0.0365878 , 2.1784911 , 0.0314793 , 2.3728994
      -3.7115779 , -0.5370809 , 2.4291716 , -0.6352663 , 2.6972781
       6.3580966 , 0.1377712 , -4.0461243 , -0.5192899 , -4.0394083];
  b = [-0.0532544 , -0.1494083 , -0.0098619
       -0.0355030 , -0.0162722 , 0.1045365
       -0.1301775 , 0.1736686 , -0.0611440
        0.1834320 , 0.1757396 , -0.5956607
        0.1775148 , -0.1186391 , 0.1439842];
  c = [2 , 7 , -2 , 5 , 1
       0 , -1 , 3 , 0 , 2];
  d = [1 , 0 , 0
       0 , 0 , 0];
sl=syslin('c',a,b,c);
if or(sl<>lsslist(a,b,c,0*ones(2,3),0*ones(5,1),'c')) then bugmes();quit;end
//
eps=sqrt(%eps);
if contr(a,b,eps)<>4 then bugmes();quit;end
if contr(a',c',4*eps)<>3 then bugmes();quit;end
spec(a);
xbasc();xselect();
plzr(sl)
//
slc=contrss(sl,eps);//ssprint(slc)
slo=obsvss(sl,eps);//ssprint(slo)
slm=minss(sl,eps);//ssprint(slm)
//
hm=ss2tf(slm);
h=ss2tf(sl);
hh=c*(s*eye()-a)^(-1)*b + 0*ones(2,3);
hh=hh-h;
if norm(coeff(hh(2))) > 1.e-5 then bugmes();quit;end
[num,den]=coff(a,'s');
hh=c*real(num)*b/real(den) + 0*ones(2,3);
hh=hh-h;
if norm(coeff(hh(2))) > 1.e-5 then bugmes();quit;end
slh=tf2ss(hm);       //was tf2ss(h)
//
u=eye(3,60);
xbasc();
