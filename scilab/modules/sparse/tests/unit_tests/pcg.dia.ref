// =============================================================================
// Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
// Copyright (C) 2008 - INRIA - Michael Baudin
//
//  This file is distributed under the same license as the Scilab package.
// =============================================================================
// Test with 2 input arguments and all output arguments
A=[10,1;1,10];
b=[11;11];
[xcomputed, flag, err, iter, res]=pcg(A,b);
Setting default value for tol
Setting default value for maxIter
Setting default value for M
Setting default value for M2
Setting default value for x
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
if flag<>0 then bugmes();quit;end
if err>%eps then bugmes();quit;end
if iter>2 then bugmes();quit;end
// Test with 3 input arguments and all output arguments
A=[10,1;1,10];
b=[11;11];
tol = 100*%eps;
[xcomputed, flag, err, iter, res]=pcg(A,b,tol);
Setting default value for maxIter
Setting default value for M
Setting default value for M2
Setting default value for x
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
if (err > tol) then bugmes();quit;end
// Test with 4 input arguments and all output arguments
A=[10,1;1,10];
b=[11;11];
tol = 100*%eps;
maxit = 10;
[xcomputed, flag, err, iter, res]=pcg(A,b,tol,maxit);
Setting default value for M
Setting default value for M2
Setting default value for x
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
// Test with 5 input arguments and all output arguments
A=[10,1;1,10];
b=[11;11];
tol = 100*%eps;
maxit = 10;
M1=[1,0;0,1];
[xcomputed, flag, err, iter, res]=pcg(A,b,tol,maxit,M1);
Setting default value for M2
Setting default value for x
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
// Test with 6 input arguments and all output arguments
A=[10,1;1,10];
b=[11;11];
tol = 100*%eps;
maxit = 10;
M1=[1,0;0,1];
M2=[1,0;0,1];
[xcomputed, flag, err, iter, res]=pcg(A,b,tol,maxit,M1,M2);
Setting default value for x
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
// Test with 7 input arguments and all output arguments
A=[10,1;1,10];
b=[11;11];
tol = 100*%eps;
maxit = 10;
M1=[1,0;0,1];
M2=[1,0;0,1];
x0=[1;1];
[xcomputed, flag, err, iter, res]=pcg(A,b,tol,maxit,M1,M2,x0);
Setting default value for x
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
// Test with non-positionnal input parameters
A=[100,1;1,10];
b=[101;11];
[xcomputed, flag, err, iter, res]=pcg(A,b,x=[-1.;2.],maxIter=3,tol=1.d-15);
Setting default value for M
Setting default value for M2
Setting default value for verbose
xexpected=[1;1];
if norm(xcomputed-xexpected)>%eps then bugmes();quit;end
if (err > 1.d-15) then bugmes();quit;end
if (iter <> 2) then bugmes();quit;end
